/******************************************************************************								
*  Name: .c
*  Description: 
*  Project: C_demo
*  Auther:  shanghai tianma
*              R&D center
*              penghu
*  MCU: S9KEAZ128AMLH
*  Comment:
******************************************************************************/		
#include <string.h>
#include "APP_COMM_data.h"
#include "../../Headers/GPIO.h"
#include "../../Headers/uart.h"
/**********************************************************************************************
* External objects
**********************************************************************************************/

/**********************************************************************************************
* Global variables
**********************************************************************************************/

/**********************************************************************************************
* Constants and macros
**********************************************************************************************/
#define APP_COMM_UART          UART_2

/**********************************************************************************************
* Local types
**********************************************************************************************/


/**********************************************************************************************
* Local function prototypes
*********************************************************************************************/

/**********************************************************************************************
* Local variables
**********************************************************************************************/


/**********************************************************************************************
* Local functions
**********************************************************************************************/
static void APP_COMM_Data_IRQHander(void);
static void APP_COMM_Data_UART_Init(void);

/**********************************************************************************************
* Global functions
**********************************************************************************************/
/***********************************************************************************************
*
* @brief    
* @param    none
* @return   none
*
************************************************************************************************/
void APP_COMM_Data_Init(void)
{
    APP_COMM_Data_UART_Init();
}
/***********************************************************************************************
*
* @brief    
* @param    none
* @return   none
*
************************************************************************************************/
void APP_COMM_Data_Send(UINT8* send_buf, UINT32 buf_size)
{
    if(NULL != send_buf)
        UART_SendWait(APP_COMM_UART, send_buf, buf_size);
}
/***********************************************************************************************
*
* @brief    
* @param    none
* @return   none
*
************************************************************************************************/
static void APP_COMM_Data_UART_Init(void)
{
    UART_ConfigType Uart_Config={{0}};

    Uart_Config.sctrl1settings.bits.bM=1;   /* 9 bit Mode */
    Uart_Config.sctrl1settings.bits.bPe=1;  /* Parity Enable */
    Uart_Config.bSbns=0;                    /* One stop bit*/
    Uart_Config.sctrl2settings.bits.bRe=1;  /* Receiver enable*/
    Uart_Config.sctrl2settings.bits.bTe=1;  /* Transmitter enable*/
    Uart_Config.sctrl2settings.bits.bRie=1; /* Receiver interrupt enable*/
    Uart_Config.u32SysClkHz = 20000000;     /* Bus clock in Hz*/
    Uart_Config.u32Baudrate = 256000;       /* Baud rate*/

    /*Initialization of UART module*/
    UART_SetCallback(APP_COMM_UART, APP_COMM_Data_IRQHander);
    UART_Init(APP_COMM_UART,&Uart_Config);
}

/***********************************************************************************************
*
* @brief    
* @param    none
* @return   none
*
************************************************************************************************/
static void APP_COMM_Data_IRQHander(void)
{
    UART_GetChar(APP_COMM_UART);
}
